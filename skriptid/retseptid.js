const retseptid = [
    {
        nimi : "Tikka Masala",
        pilt : '../../pildid/toit1.png',
        hinnang : 4.5,
        tudengisõbralikkus : 4.0, 
        koostisosad : { 
            'kana marinaadis' : [ '1kg kanakintse', '200ml kreeka jogurtit', '2tl Garam Masalat', '3tl soola' ],
            'vürtsisegu' : [ '1.5tl Garam Masalat', '1.5tl jahvatatud köömneid', '1tl karrit', '1tl jahvatatud koriandrit', '1tl tsilli pulbrit', '1tl kurkumi' ],
            'kastmeks' : [ '6cm tükk ingverit', '5 küüslaugu küünt', '1 tsilli', '1 suur sibul või 2 keskmist', '400g terveid või purustatud tomateid', '200ml koort', '1tl suhkrut', 'soola ja pipart maitse järgi', 'soovi korral MSG' ]
        },
        sammud : {
            'tikka masala' : [ `Lõika kana ampsusuurusteks tükkideks. Ei ole kohustuslik aga rangelt soovitan
                kasutada kana kintse selles retseptis, esiteks tuleb kana palju maitsvam ja
                mahlasem.. lisa kanale kreeka jogurt, mahl ühest sidrunist, 2 teelusikatäit garam
                masalat ja soola. Sega ringi kuni kana on jogurtiga katetud ja pane kausile plast
                peale, paneme ta külmkappi ja jätame temaga umbes 30-12 tundi hüvasti.`,
                `Tükelda oma sibul, mida väiksemad tükid seda parem, mulle meeldib kasutada
                palju sibulat selles retseptis. Kui soovid veidi rohkem särtsu oma rooga, siis tükelda
                ka veidi tsillit. Lõpuks riivi ingver ja küüslauk ühte kuhja.`,
                `Tee pann kuumaks kõige kõrgemal temperatuuril ja lisa rikkalikult õli. Võta siis kana
                külmkapist välja ja viska panni peale. Prae kana korralikult pruuniks ja pane kõrvale.
                Soovitan praadida kana mitmes seerias. Kui kana on pruun, võta pann kuuma pealt
                maha ja lisa korralikult võid, prae või sees sibul kuni pruun, võid lisada soola et
                läheks kiiremini , lisa panni tsilli koos ingveri ja küüslauguga ning prae kuni köögis
                on intensiivne aroom. Lisa siis oma vürtsisegu ja prae umbes 20 sekundit.`,
                `Vala panni tomatid, kraabi panni põhja, et saada kõik maitsed põhjast lahti. Lisa siis
                kastmele soola, suhkurt ja kui soovid ka natukene MSG-d ja lase kastmel podiseda
                kuni on paksem (umbes 5 minutit). Lisa koor, sega läbi ja lisa kana tagasi sisse,
                lase kõigel veelkord podiseda.`,
                `Nüüd on lõpuks aeg serveerida. Ilupunktideks võid lisada tikka masalale värsket
                koriandrit ja veidikene veel koort. Serveeri üle riisi või koos naaniga.` ],
            'masala' : [ `Vürtsisegu ehk masala tegemiseks lisa kaussi poolteist teelusikat jahvatatud köömneid,
                poolteist teeluskat garam masalat, 1 teelusikas karrit, 1 teelusikas kurkumit, ning 1
                teelusikatäis chilli pulbrit, sega kõik kokku ja su rikkalik Tikka Masala vürtsisegu ongi
                valminud.` ]
        }
    },
    {
        nimi : "Gnocchi Al Limone",
        pilt : '../../pildid/toit1.png',
        hinnang : 4.6,
        tudengisõbralikkus : 4.5, 
        koostisosad : [ '1kg jahuseid kartuleid', '1 sidrun (sidrunikoor ja sidrunimahl eraldatud)', '100 grammi riivitud parmigiano reggiano + veel serveerimiseks', '300 grammi jahu', '120 grammi võid', '15 piparmündi lehte', 'Värskelt purustatud pipar' ],
        sammud : [ `Täida pott veega, viska kartulid otse vette ja lase keema, keeda kuni saad lihtsalt
            kahvliga kartulisse torkida`,
            `Kui kartulid on kahvliga torkimiseks piisavalt pehmed, võta nad keevast veest välja, lase
            maha jahtuda ja eemalda koored`,
            `Tee kartulid pudruks, lisa pool oma sidrunikoorest, 1 pekstud muna ja sega, nyyd on
            aeg hakata jahu lisama, lisa vaikselt jahu ja sõtku kuni meenutab taigent. Protsessi
            lõpuks oled sa lisanud jahu umbes 25-30% kartuli kaalust. minu puhul 300 grammi.`,
            `Veereta siis pikaks ussiks ja lõika gnocchikesed välja.`,
            `Kastme jaoks, viska panni sitaks võid ja lase sulada. Lisa piparmünt ja sidrunimahl või
            hulka ning sega. Viska gnocchid kõrvale olevasse potti soolatud veega, keeda kuni
            gnfocchit tõusevad pinna peale ning tõsta nad kaussi.`,
            `Vala või kaste gnocchide hulka, sega, sega ,sega. Lisa siis parmesan, tähtis on et
            gnocchid on veel soojad et kaste saaks sulada kokku. Sega siis uuesti, lisa pasta vett
            kuni saavutad kastmel meeldiva paksuse, lõpuks maitse ja lisa vajaduse korral soola.`,
            `Nüüd serveeri soojal taldrikul, gnocchi, riivitud parmesan, ilu pärast piparmündi leht ja
            värskelt purustatud pipart.` ]
    },

    {
        nimi : "Kana Karahi",
        pilt : '../../pildid/toit1.png',
        hinnang : 4.7,
        tudengisõbralikkus : 4.2, 
        koostisosad : { 
            'kana' : [ '650 grammi kanakintse', '10cm tükk ingverit pool riivitud pool pulkadeks lõigatud', 'Küüned ühelt küüslaugult purustatud/riivitud', '3 tomatit', '2 tsillit', 'Koriander', '2tl garam masalat' ],
            'karahi masala' : [ '1tl köömneid', '1tl koriandrit', '1tl apteegitilli', '1tl pipraterasid', '1tl kurkum', '1tl tsilli või paprika' ]
        },
        sammud : [ `Ettevalmistuseks tükelda kana kintsud aga jäta nad siiski suht suurteks tükkideks.
            Riivi ingver ja küüslauk, tee valmis masala (vürtsisegu) ja lõika lahti tsilli, võta
            seemned välja kui tahad, et roog oleks vähem vürtsikas`,
            `Kasuta panni mis kannatab kõrgeid temperatuure, tee väga kuumaks ja lisa õli. Kui
            paned käe panni kohale ja ei saa rohkem kui 5 sekundit mugavalt hoida, on pann
            piisavalt kuum Siis on aeg visata kana pannile. Tehke seda kahes etapis et panni
            mitte ülekoormada ja tervet toitu untsu ajada kuna mõnusalt pruun kana on siin
            retseptis ekstreemselt tähtis.`,
            `Kui kana on pruun siis lisa ingveri küüslaugu pasta ja prae koos kanaga umbes 15
            sekundit enne kui viskad tomatid sisse. Prae ja purusta tomateid kuni kujuneb
            kaste. Laske sellel kastmel siis podiseda kuni suur osa vedelikust on ära aurunud ja
            kaste on paksem.`,
            `Lisage siis oma imelised vürtsid, koos natukese salasoola ja garam masalaga see
            on ka õige aeg et lisada chili. Laske siis kõigel veel podiseda kuni kaste on hõrk,
            paks ja katab kõik koostisosad.`,
            `Maitske siis uuesti ja lisage maitse järgi soola, vajadusel veel garam masalat ja
            nüüd on aeg roa kokkuvõtvaks hetkeks kus lisame meie kenad ingveripulgad ja
            koriandri ning segame viimast korda enne serveerimist.`,
            `Serveeri üle riisi, kartulite või koos naaniga.`
        ]
    }
]

const loo_element = ( tag_nimi ) => document.createElement( tag_nimi ) // loo_element = document.createElement ei sobi :((((((

const loo_reiting = ( reiting_number, lisatekst ) => {
    let tähtede_arv = Math.floor( reiting_number + 0.5 )

    let tähed = '★'.repeat( tähtede_arv ) + '☆'.repeat( 5 - tähtede_arv )

    let vanem = loo_element( 'div' )
    vanem.className = 'reiting-tekst'

    if ( lisatekst ) {
        vanem.innerText = lisatekst
    }

    let reiting = loo_element( 'p' )
    reiting.className = 'reiting'
    reiting.innerText = tähed

    vanem.appendChild( reiting )

    return vanem
}

const loo_modal = ( retsepti_info ) => {
    // uus element mis on kogu lehe peal
    let modal_konteiner = loo_element( 'div' )
    modal_konteiner.className = 'modal-konteiner'

    let modal_vanem = loo_element( 'div' )
    modal_vanem.className = 'modal'

    modal_konteiner.appendChild( modal_vanem )

    let pealis_konteiner = loo_element( 'div' )
    pealis_konteiner.className = 'pealis-konteiner'

    let pealis = loo_element( 'h1' )
    pealis.innerText = `Retsept ${ retsepti_info.nimi }`

    let sulge_modal = loo_element( 'h2' )
    sulge_modal.innerText = 'Sulge [X]'

    pealis_konteiner.appendChild( pealis )
    pealis_konteiner.appendChild( sulge_modal )
    modal_vanem.appendChild( pealis_konteiner )

    let koostisosad_pealis = loo_element( 'h2' )
    koostisosad_pealis.innerText = 'Koostisosad'
    modal_vanem.appendChild( koostisosad_pealis )

    let koostisosade_vanem = loo_element( 'div' )
    koostisosade_vanem.className = 'koostisosad-konteiner'

    // Kuna koostisosad on vahelduvalt dict/arr tüüpidega (soltub retseptist mida valmistatakse), siis kontrollime seda
    let koostisosad = retsepti_info.koostisosad
    
    if ( Array.isArray( retsepti_info.koostisosad ) ) {
        koostisosad = { 'vaja läheb' : retsepti_info.koostisosad }
    }

    // Iga erineva koostisosade listi kohta loome uue HTML listi

    for ( let nimi of Object.keys( koostisosad ) ) {
        let koostisosa_konteiner = loo_element( 'div' )
        koostisosa_konteiner.className = 'koostisosa_konteiner'

        let list_nimi = loo_element( 'p' )
        list_nimi.className = 'koostiosade-nimi'
        list_nimi.innerText = nimi

        let list_vanem = loo_element( 'ul' )
        list_vanem.className = 'koostisosa-list'

        // Iga koostisosa kohta uus li element
        for ( let koostisosa of koostisosad[ nimi ] ) {
            let koostiosa_li = loo_element( 'li' )
            koostiosa_li.innerText = koostisosa

            list_vanem.appendChild( koostiosa_li )
        }
        
        koostisosa_konteiner.appendChild( list_nimi )
        koostisosa_konteiner.appendChild( list_vanem )

        koostisosade_vanem.appendChild( koostisosa_konteiner )
    }
    modal_vanem.appendChild( koostisosade_vanem )

    // Sammud

    let sammud_pealis = loo_element( 'h2' )
    sammud_pealis.innerText = 'Sammud'

    // Samamoodi nagu koostisosades, saab sammudel olla eri osad (erinevad valmistatavad toidud)
    let sammud = retsepti_info.sammud
    
    if ( Array.isArray( sammud ) ) {
        sammud = { '42' : sammud }
    }

    for ( let nimi of Object.keys( sammud ) ) {
        let list_nimi = nimi === '42' ? undefined : loo_element( 'h3' )

        let list_vanem = loo_element( 'ol' )

        // Iga sammu kohta uus li element
        for ( let samm of sammud[ nimi ] ) {
            let samm_li = loo_element( 'li' )
            samm_li.innerText = samm

            list_vanem.appendChild( samm_li )
        }
        
        if ( list_nimi ) {
            list_nimi.className = 'koostiosade-nimi'
            list_nimi.innerText = nimi
            modal_vanem.appendChild( list_nimi )
        }
        modal_vanem.appendChild( list_vanem )
    }

    sulge_modal.onclick = ( _ ) => {
        document.body.removeChild( modal_konteiner )
    } 
    
    document.body.appendChild( modal_konteiner )
}

const retseptikogumik = document.getElementById( 'retseptid' )

for ( let retseptiobjekt of retseptid ) {
    // <div class="retsept">
    //     <div class="pilt" style="--pilt: url(../../pildid/toit1.png)">
    //     </div>
    //     <div class="info">
    //         <h1 class="nimi">Toidu Nimi</h1>

    //         <div class="reiting-tekst">
    //             <p class="reiting">★★★★☆</p>
    //         </div>

    //         <div class="reiting-tekst">
    //             <p>Tudengisõbralikkus <p class="reiting">★★★☆☆</p></p>
    //         </div>

    //         <a href="#">Loe lisaks</a>
    //     </div>
    // </div>
    let retseptikonteiner = loo_element( 'div' )
    retseptikonteiner.className = 'retsept-konteiner'

    let retsept = loo_element( 'div' )
    retsept.className = 'retsept'

    let pilt = loo_element( 'div' )
    pilt.className = 'pilt'
    pilt.style = `--pilt: url(${ retseptiobjekt.pilt })`

    retsept.appendChild( pilt )

    let info = loo_element( 'div' )
    info.className = 'info'

    let nimi = loo_element( 'h1' )
    nimi.className = 'nimi'
    nimi.innerText = retseptiobjekt.nimi

    let reiting_toit = loo_reiting( retseptiobjekt.hinnang )
    let reiting_sõbralikkus = loo_reiting( retseptiobjekt.tudengisõbralikkus, 'Tudengisõbralikkus' )

    let loe_lisaks = loo_element( 'a' )
    loe_lisaks.href = '#'
    loe_lisaks.innerText = 'Loe lisaks'

    loe_lisaks.onclick = ( e ) => {
        e.preventDefault( )

        loo_modal( retseptiobjekt )
    }

    info.appendChild( nimi )
    info.appendChild( reiting_toit )
    info.appendChild( reiting_sõbralikkus )
    info.appendChild( loe_lisaks )

    retsept.appendChild( info )

    retseptikonteiner.appendChild( retsept )

    retseptikogumik.appendChild( retseptikonteiner )
}